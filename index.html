<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dreadwood Testbed</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="game-container">
        <button id="btn-help" class="help-button" title="How to Play">?</button>

        <div id="screen-player-count" class="screen active">
            <p>Select the number of players:</p>
            <div class="button-container">
                <button id="btn-2-players" data-count="2">2 Players</button>
                <button id="btn-3-players" data-count="3">3 Players</button>
                <button id="btn-4-players" data-count="4">4 Players</button>
            </div>
        </div>

        <div id="screen-player-setup" class="screen">
            <h2 id="player-setup-title">Player X Setup</h2>

            <div class="setup-section">
                <label>Select Class:</label>
                <div id="class-selection-buttons" class="button-container class-buttons">
                    <button class="btn-class" data-class="Sheriff">Sheriff</button>
                    <button class="btn-class" data-class="Vigilante">Vigilante</button>
                    <button class="btn-class" data-class="Outlaw">Outlaw</button>
                    <button class="btn-class" data-class="Bounty Hunter">Bounty Hunter</button>
                </div>
            </div>

            <div id="class-details-container" class="setup-section class-details-box">
                <h3>Selected Class Details:</h3>
                <p id="class-name"><strong>Class:</strong> ---</p>
                <p id="class-description"><i>Select a class above to see details.</i></p>
                <h4>Abilities:</h4>
                <ul id="class-abilities">
                    <li>---</li>
                </ul>
            </div>

            <div class="setup-section">
                <label id="player-name-label" for="input-player-name">Player X Name:</label>
                <input type="text" id="input-player-name" placeholder="Enter Name (Optional)">
            </div>

            <div class="navigation-buttons button-container">
                <button id="btn-back">Back</button>
                <button id="btn-back-to-start">Back to Start</button>
                <button id="btn-next">Next</button>
            </div>
        </div>

        <div id="screen-gameplay" class="screen">

            <div id="game-board-container">
                <div id="game-board" class="grid-container">
                    </div>
            </div>

            <div id="action-bar" class="button-container action-buttons">
                <button id="action-shoot" title="Shoot (3 AP)">🔫 Shoot</button>
                <button id="action-throw" title="Throw Hazard (1/2 AP)">✋ Throw</button>
                <button id="action-silver-bullet" title="Silver Bullet Shot (3 AP)">💎 Silver</button>
                <button id="action-dispel" title="Dispel Grave Dust (3 AP)">🪄 Dispel</button>
                <button id="action-bite-fuse" title="Bite the Fuse (1 AP)">😬 Bite Fuse</button>
                <button id="action-rampage" title="Rampage (2 AP, 1/game)" style="display: none;">🤬 Rampage</button>
                <button id="action-hand-cannon" title="Hand Cannon (5 AP, 1/game)" style="display: none;">🚀 Hand Cannon</button>
                <button id="action-contract-payoff" title="Contract Payoff (3 AP, 1/game)" style="display: none;">💰 Contract</button>
                <button id="action-order-restored" title="Order Restored (3 AP, 1/game)" style="display: none;">📛 Order Restored</button>
                <button id="action-vengeance" title="Vengeance is Mine (0 AP, 1/game)" style="display: none;">😏 Vengeance</button>
            </div>

            <div id="movement-bar" class="button-container movement-buttons hidden">
                <button id="move-n" class="move-button" data-direction="N" title="Move/Pivot North (1 AP)">⬆️</button>
                <button id="move-w" class="move-button" data-direction="W" title="Move/Pivot West (1 AP)">⬅️</button>
                <button id="move-e" class="move-button" data-direction="E" title="Move/Pivot East (1 AP)">➡️</button>
                <button id="move-s" class="move-button" data-direction="S" title="Move/Pivot South (1 AP)">⬇️</button>
            </div>

            <div id="player-info">
                <div id="status-bar">
                    <strong>Current Turn:</strong> <span id="status-player">---</span> |
                    <strong>AP:</strong> <span id="status-ap">X</span>
                </div>

                <div id="game-controls" class="button-container">
                    <button id="btn-undo" disabled>Undo Last Action</button>
                    <button id="btn-end-turn">End Turn</button>
                </div>

                <div id="current-class-details" class="setup-section class-details-box">
                     <h3>Current Player Info:</h3>
                     <ul id="info-class-abilities"><li>---</li></ul>
                     <p><strong>Silver Bullet:</strong> <span id="info-silver-bullet">Available</span></p>
                </div>
            </div>

            <div id="game-log-container">
                <button id="btn-toggle-log">Show/Hide Log</button>
                <div id="game-log" class="log-hidden">
                    <h4>Game Log</h4>
                    <ul id="log-list">
                        <li>Game Started...</li>
                    </ul>
                </div>
            </div>

            <div class="button-container" style="margin-top: 30px;">
                 <button id="btn-back-to-setup">Back to Setup (Dev)</button>
            </div>

        </div> <div id="screen-how-to-play" class="screen popup">
            <div class="popup-content">
                <h2>How to Play Dreadwood</h2>
                <div class="how-to-play-content">
                    <h3>The Goal</h3>
                    <p>Welcome to the Dreadwood, a haunted frontier stalked by rival vampires! Choose one of four unique factions (like the orderly Sheriffs or chaotic Outlaws) and lead your pair of bloodsuckers to dominance. Your objective is to outlast the competition and be the final faction surviving on the board.</p>
                    <h3>Your Turn</h3>
                    <p>Each turn, you get Action Points (AP) to spend commanding your two vampires. Use these points thoughtfully for movement, attacks, and setting traps. Once you've used your AP, your turn ends, and the next player goes.</p>
                    <h3>Basic Actions</h3>
                    <ul>
                        <li><strong>Pivot:</strong> Change the direction your selected vampire faces to prepare your next move or shot. (1 AP)</li>
                        <li><strong>Move:</strong> Step one square forward in the direction your vampire is facing. Some obstacles, like sticky Black Widow webs (🕷️), might block your path! (1 AP)</li>
                        <li><strong>Shoot:</strong> Fire your weapon straight ahead. A well-aimed shot can destroy vital enemy Bloodwells (🩸) or even hit rival vampires (sometimes with special effects!). Certain obstacles like Tombstones (🪦) or volatile Dynamite (💥) will block your shot. (3 AP)</li>
                        <li><strong>Throw Hazard:</strong> Toss obstacles like blocking Tombstones, entangling Black Widow webs, dangerous Dynamite, or cursing Grave Dust (💩) onto the board (up to 3 squares ahead) to disrupt your foes or create cover. (1 AP / 2 AP for 💥)</li>
                        </ul>
                    <h3>Key Things to Know</h3>
                    <ul>
                        <li><strong>Bloodwells (🩸):</strong> These arcane fonts are your faction's lifeline. Protect yours fiercely! If an enemy destroys all three, your connection is severed, and your faction is eliminated!</li>
                        <li><strong>Hazards:</strong> Use obstacles to your advantage! Tombstones block shots & throw paths, Black Widow webs stop movement, Grave Dust curses those who tread on it, and Dynamite creates explosive chaos when shot. Learn their effects to outsmart your rivals.</li>
                        <li><strong>Cursed (Purple Ring):</strong> Step onto Grave Dust or suffer certain attacks, and your vampire becomes cursed! They'll be slowed down (only one move attempt per turn!) and unable to use some actions until they cleanse themselves near the arcane energy of *any* Bloodwell (even an enemy's!).</li>
                        <li><strong>Silver Bullet (💎):</strong> You get one special bullet per game. It's incredibly potent – a direct hit instantly eliminates an enemy vampire! Make it count. (Uses Shoot action, 3 AP)</li>
                        <li><strong>Faction Powers:</strong> Don't forget your faction's unique abilities! Using them at the right time can turn the tide of battle.</li>
                    </ul>
                    <h3>Winning</h3>
                    <p>Eliminate your rivals by either destroying all their Bloodwells OR by taking out both of their vampires. The last faction standing claims the Dreadwood!</p>
                </div>
                <div class="button-container">
                     <button id="btn-back-to-game">Back to Game</button>
                </div>
            </div>
        </div>
            
        <div id="popup-elimination" class="popup">
             <div class="popup-content">
                 <h3 id="elimination-title">Player Eliminated!</h3>
                 <p id="elimination-message">[Player Name] has been eliminated.</p>
                 <button id="btn-close-elimination">OK</button>
             </div>
        </div>

        <div id="popup-victory" class="popup">
             <div class="popup-content">
                 <h3 id="victory-title">Victory!</h3>
                 <p id="victory-message">[Player Name] Wins!</p>
                 <button id="btn-restart-victory">Restart Game</button>
             </div>
        </div>

        <div id="hazard-picker" class="popup">
             <div class="popup-content">
                 <h4>Select Hazard to Throw</h4>
                 <p>Available:</p>
                 <div id="hazard-picker-options" class="button-container">
                     </div>
                 <button id="btn-cancel-throw" style="background-color: #6c757d; margin-top: 15px;">Cancel Throw</button>
             </div>
        </div>

        <div id="popup-contract-payoff-choice" class="popup">
            <div class="popup-content">
                <h3>Contract Payoff?</h3>
                <p id="cp-choice-message">You destroyed an enemy Bloodwell! Activate Contract Payoff now for a 2 AP bonus next turn, or wait for a chance at a larger payoff (4 AP) if you destroy a second one?</p>
                <div class="button-container" style="margin-top: 25px;">
                    <button id="btn-cp-choice-yes">Yes (Take 2 AP Bonus)</button>
                    <button id="btn-cp-choice-no">No (Wait for More)</button>
                </div>
            </div>
        </div>

        <div id="popup-contract-payoff-auto" class="popup">
            <div class="popup-content">
                <h3>Contract Payoff!</h3>
                <p id="cp-auto-message">Second Bloodwell destroyed! Contract Payoff automatically activated. You gain a 4 AP bonus at the start of your next turn.</p>
                <div class="button-container" style="margin-top: 25px;">
                    <button id="btn-cp-auto-ok">OK</button>
                </div>
            </div>
        </div>

        <div id="popup-next-turn-bonus" class="popup">
            <div class="popup-content">
                <h3>AP Bonus Applied!</h3>
                <p id="ntb-message">Bonus applied at the start of this turn!</p> <div class="button-container" style="margin-top: 25px;">
                    <button id="btn-ntb-ok">OK</button>
                </div>
            </div>
        </div>

    </div> <script src="script.js" defer></script>
</body>
</html>

    </div><script src="script.js" defer></script>
</body>
</html>
